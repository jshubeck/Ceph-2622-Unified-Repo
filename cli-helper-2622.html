<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.4px 'Helvetica Neue'; color: #651913; -webkit-text-stroke: #651913}
    p.p6 {margin: 0.0px 0.0px 15.0px 0.0px; font: 12.8px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.8); -webkit-text-stroke: rgba(0, 0, 0, 0.8)}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.9px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.9); -webkit-text-stroke: rgba(0, 0, 0, 0.9); background-color: #f6f6f6}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.9px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.9); -webkit-text-stroke: rgba(0, 0, 0, 0.9)}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.9px 'Helvetica Neue'; color: #a90e1a; -webkit-text-stroke: #a90e1a; background-color: #f6f6f6}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.9px 'Helvetica Neue'; color: #a90e1a; -webkit-text-stroke: #a90e1a}
    p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #651913; -webkit-text-stroke: #651913}
    p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.9px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.9); -webkit-text-stroke: rgba(0, 0, 0, 0.9); background-color: #f6f6f6; min-height: 13.0px}
    p.p14 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.9px 'Helvetica Neue'; color: #0f7001; -webkit-text-stroke: #0f7001; background-color: #f6f6f6}
    p.p15 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.9px 'Helvetica Neue'; color: #0f7001; -webkit-text-stroke: #0f7001}
    p.p16 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #ffffff; color: rgba(255, 255, 255, 0.8); -webkit-text-stroke: rgba(255, 255, 255, 0.8)}
    li.li3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.8px 'Helvetica Neue'; color: #1a4194; -webkit-text-stroke: #1a4194}
    span.s1 {font-kerning: none}
    span.s2 {font-kerning: none; background-color: #f6f6f5}
    span.s3 {background-color: #f6f6f5; -webkit-text-stroke: 0px #000000}
    span.s4 {font-kerning: none; color: #0f7001; -webkit-text-stroke: 0px #0f7001}
    span.s5 {font-kerning: none; color: #130869; -webkit-text-stroke: 0px #130869}
    span.s6 {font-kerning: none; color: #535353; -webkit-text-stroke: 0px #535353}
    span.s7 {font-kerning: none; background-color: #f6f6f6}
    span.s8 {font-kerning: none; color: #535353; background-color: #f6f6f6; -webkit-text-stroke: 0px #535353}
    span.s9 {font-kerning: none; color: #ab4f75; background-color: #f6f6f6; -webkit-text-stroke: 0px #ab4f75}
    span.s10 {font-kerning: none; color: #130869; background-color: #f6f6f6; -webkit-text-stroke: 0px #130869}
    span.s11 {font-kerning: none; color: rgba(0, 0, 0, 0.9); -webkit-text-stroke: 0px rgba(0, 0, 0, 0.9)}
    span.s12 {font-kerning: none; color: #ab4f75; -webkit-text-stroke: 0px #ab4f75}
    span.s13 {font-kerning: none; color: rgba(0, 0, 0, 0.9); background-color: #f6f6f6; -webkit-text-stroke: 0px rgba(0, 0, 0, 0.9)}
    span.s14 {font-kerning: none; color: #a90e1a; background-color: #f6f6f6; -webkit-text-stroke: 0px #a90e1a}
    span.s15 {font-kerning: none; color: #a90e1a; -webkit-text-stroke: 0px #a90e1a}
    span.s16 {font-kerning: none; color: #0f7001; background-color: #f6f6f6; -webkit-text-stroke: 0px #0f7001}
    span.s17 {font-kerning: none; background-color: rgba(0, 0, 0, 0.8)}
    ul.ul1 {list-style-type: none}
  </style>
</head>
<body>
<h1 style="margin: 0.0px 0.0px 0.0px 0.0px; font: 33.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.85); -webkit-text-stroke: rgba(0, 0, 0, 0.85)"><span class="s1">TXC 2025 - Lab 2622 Helper Commands</span></h1>
<p class="p2"><span class="s2">Table of Contents</span></p>
<ul class="ul1">
  <li class="li3"><span class="s3"></span><span class="s2">1. Introduction</span></li>
  <ul class="ul1">
    <li class="li3"><span class="s3"></span><span class="s2">1.1. About this Lab</span></li>
    <li class="li3"><span class="s3"></span><span class="s2">1.2. High Level Architecture</span></li>
    <li class="li3"><span class="s3"></span><span class="s2">1.3. Accessing your Lab environment</span></li>
  </ul>
  <li class="li3"><span class="s3"></span><span class="s2">2. IBM Storage Ceph configuration using the Dashboard</span></li>
  <ul class="ul1">
    <li class="li3"><span class="s3"></span><span class="s2">2.1. Introduction</span></li>
    <li class="li3"><span class="s3"></span><span class="s2">2.2. Connect to the Jump Workstation Desktop</span></li>
    <li class="li3"><span class="s3"></span><span class="s2">2.3. Set the admin password</span></li>
    <li class="li3"><span class="s3"></span><span class="s2">2.4. Expand the cluster</span></li>
    <li class="li3"><span class="s3"></span><span class="s2">2.5. Add Node Labels</span></li>
    <li class="li3"><span class="s3"></span><span class="s2">2.6. Add Drives/OSDs to the Cluster</span></li>
    <li class="li3"><span class="s3"></span><span class="s2">2.7. Accept Grafana Self-Signed Cert to view performance details</span></li>
  </ul>
  <li class="li3"><span class="s3"></span><span class="s2">3. Configuring Services</span></li>
  <ul class="ul1">
    <li class="li3"><span class="s3"></span><span class="s2">3.1. Label hosts for specific services</span></li>
    <li class="li3"><span class="s3"></span><span class="s2">3.2. Service Creation</span></li>
    <ul class="ul1">
      <li class="li3"><span class="s3"></span><span class="s2">3.2.1. Edit Grafana Service</span></li>
      <li class="li3"><span class="s3"></span><span class="s2">3.2.2. RGW Service Creation</span></li>
      <li class="li3"><span class="s3"></span><span class="s2">3.2.3. NFS Service Creation</span></li>
    </ul>
    <li class="li3"><span class="s3"></span><span class="s2">3.3. Configure Storage</span></li>
    <ul class="ul1">
      <li class="li3"><span class="s3"></span><span class="s2">3.3.1. RADOS Gateway Pool Creation</span></li>
      <li class="li3"><span class="s3"></span><span class="s2">3.3.2. Ceph File System Configuration</span></li>
    </ul>
    <li class="li3"><span class="s3"></span><span class="s2">3.4. Configure S3 User and S3 Bucket</span></li>
    <ul class="ul1">
      <li class="li3"><span class="s3"></span><span class="s2">3.4.1. Create S3 User</span></li>
      <li class="li3"><span class="s3"></span><span class="s2">3.4.2. Create S3 Bucket</span></li>
    </ul>
    <li class="li3"><span class="s3"></span><span class="s2">3.5. Create NFS Export for a CephFS Directory</span></li>
    <li class="li3"><span class="s3"></span><span class="s2">3.6. Create NFS Export for a S3 Bucket</span></li>
  </ul>
  <li class="li3"><span class="s3"></span><span class="s2">4. Use Cases</span></li>
  <ul class="ul1">
    <li class="li3"><span class="s3"></span><span class="s2">4.1. Object Use Case</span></li>
    <ul class="ul1">
      <li class="li3"><span class="s3"></span><span class="s2">4.1.1. Install AWS CLI</span></li>
      <li class="li3"><span class="s3"></span><span class="s2">4.1.2. Configure AWS CLI</span></li>
      <li class="li3"><span class="s3"></span><span class="s2">4.1.3. Using AWS Client</span></li>
    </ul>
    <li class="li3"><span class="s3"></span><span class="s2">4.2. NFS Access</span></li>
    <ul class="ul1">
      <li class="li3"><span class="s3"></span><span class="s2">4.2.1. Mount /nfs export</span></li>
      <li class="li3"><span class="s3"></span><span class="s2">4.2.2. Mount /demo-bucket export</span></li>
    </ul>
    <li class="li3"><span class="s3"></span><span class="s2">4.3. RBD Access</span></li>
  </ul>
</ul>
<h2 style="margin: 0.0px 0.0px 13.9px 0.0px; font: 27.8px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">1. Introduction</span></h2>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">1.1. About this Lab</span></h3>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">1.2. High Level Architecture</span></h3>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">1.3. Accessing your Lab environment</span></h3>
<p class="p6"><span class="s1">Accessing your Lab Workstation (the physical laptop) via ssh:</span></p>
<p class="p7"><span class="s4">export</span><span class="s1"> </span><span class="s5">USERNAME</span><span class="s6">={</span><span class="s1">your_username</span><span class="s6">}</span></p>
<p class="p7"><span class="s4">export</span><span class="s1"> </span><span class="s5">USERIP</span><span class="s6">={</span><span class="s1">your_public_ip</span><span class="s6">}</span></p>
<p class="p7"><span class="s1">chmod </span><span class="s6">0600</span><span class="s1"> ~/Downloads/ssh_private_key.pem</span></p>
<p class="p8"><span class="s7">ssh -i ~/Downloads/ssh_private_key.pem -p </span><span class="s8">2223</span><span class="s7"> </span><span class="s9">${</span><span class="s10">USERNAME</span><span class="s9">}</span><span class="s7">@</span><span class="s9">${</span><span class="s10">USERIP</span><span class="s9">}</span></p>
<p class="p6"><span class="s1">Accessing your Workstation (the physical laptop) using a browser via CLI</span></p>
<p class="p6"><span class="s1">Windows:</span></p>
<p class="p7"><span class="s1">cmd.exe</span></p>
<p class="p7"><span class="s4">set</span><span class="s1"> </span><span class="s5">USERIP</span><span class="s6">={</span><span class="s1">your_public_ip</span><span class="s6">}</span></p>
<p class="p8"><span class="s7">start https://</span><span class="s9">${</span><span class="s10">your_public_ip</span><span class="s9">}</span></p>
<p class="p6"><span class="s1">MacOS/Linux:</span></p>
<p class="p7"><span class="s4">set</span><span class="s1"> </span><span class="s5">USERIP</span><span class="s6">={</span><span class="s1">your_public_ip</span><span class="s6">}</span></p>
<p class="p9"><span class="s11">open -a </span><span class="s1">"Google Chrome"</span><span class="s11"> </span><span class="s1">"https://</span><span class="s12">${</span><span class="s5">USERIP</span><span class="s12">}</span><span class="s1">"</span></p>
<p class="p10"><span class="s13">open -a </span><span class="s7">"Safari"</span><span class="s13"> </span><span class="s7">"https://</span><span class="s9">${</span><span class="s10">USERIP</span><span class="s9">}</span><span class="s7">"</span></p>
<h2 style="margin: 0.0px 0.0px 13.9px 0.0px; font: 27.8px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">2. IBM Storage Ceph configuration using the Dashboard</span></h2>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">2.1. Introduction</span></h3>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">2.2. Connect to the Jump Workstation Desktop</span></h3>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">2.3. Set the admin password</span></h3>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">2.4. Expand the cluster</span></h3>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">2.5. Add Node Labels</span></h3>
<p class="p8"><span class="s7">grep node1 /etc/hosts | awk </span><span class="s14">'{ print $2 }'</span><span class="s7"> | sed -e </span><span class="s14">'s/node1-/node[2-4]-/g'</span></p>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">2.6. Add Drives/OSDs to the Cluster</span></h3>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">2.7. Accept Grafana Self-Signed Cert to view performance details</span></h3>
<p class="p11"><span class="s1">Generate URL for Certificate exception</span></p>
<p class="p10"><span class="s13">grep node1 /etc/hosts | awk </span><span class="s7">'{ print $2 }'</span><span class="s13">| sed -e </span><span class="s7">'s#ceph-node1-#https://ceph-node1-#g'</span><span class="s13"> | sed -e </span><span class="s7">'s/$/:3000/'</span></p>
<h2 style="margin: 0.0px 0.0px 13.9px 0.0px; font: 27.8px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3. Configuring Services</span></h2>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.1. Label hosts for specific services</span></h3>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.2. Service Creation</span></h3>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.2.1. Edit Grafana Service</span></h4>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.2.2. RGW Service Creation</span></h4>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.2.3. NFS Service Creation</span></h4>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.3. Configure Storage</span></h3>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.3.1. RADOS Gateway Pool Creation</span></h4>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.3.2. Ceph File System Configuration</span></h4>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.4. Configure S3 User and S3 Bucket</span></h3>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.4.1. Create S3 User</span></h4>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.4.2. Create S3 Bucket</span></h4>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.5. Create NFS Export for a CephFS Directory</span></h3>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">3.6. Create NFS Export for a S3 Bucket</span></h3>
<h2 style="margin: 0.0px 0.0px 13.9px 0.0px; font: 27.8px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">4. Use Cases</span></h2>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">4.1. Object Use Case</span></h3>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">4.1.1. Install AWS CLI</span></h4>
<p class="p8"><span class="s7">sudo dnf install awscli -y</span></p>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">4.1.2. Configure AWS CLI</span></h4>
<p class="p11"><span class="s1">Extract Autogenerated access and secret keys</span></p>
<p class="p8"><span class="s7">ssh ceph-node1 sudo radosgw-admin user info --uid</span><span class="s8">=</span><span class="s7">labuser | jq -r </span><span class="s14">'.keys[0] | .access_key, .secret_key'</span></p>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">4.1.3. Using AWS Client</span></h4>
<p class="p11"><span class="s1">Configure keys to use</span></p>
<p class="p7"><span class="s4">export</span><span class="s1"> </span><span class="s5">AKEY</span><span class="s6">=</span><span class="s4">$(</span><span class="s1">ssh ceph-node1 sudo radosgw-admin user info --uid</span><span class="s6">=</span><span class="s1">demouser | jq -r </span><span class="s15">'.keys[0].access_key'</span><span class="s4">)</span><span class="s1">;</span><span class="s4">echo</span><span class="s1"> </span><span class="s5">$AKEY</span></p>
<p class="p7"><span class="s4">export</span><span class="s1"> </span><span class="s5">SKEY</span><span class="s6">=</span><span class="s4">$(</span><span class="s1">ssh ceph-node1 sudo radosgw-admin user info --uid</span><span class="s6">=</span><span class="s1">demouser | jq -r </span><span class="s15">'.keys[0].secret_key'</span><span class="s4">)</span><span class="s1">;</span><span class="s4">echo</span><span class="s1"> </span><span class="s5">$SKEY</span></p>
<p class="p7"><span class="s1">aws configure </span><span class="s4">set</span><span class="s1"> aws_access_key_id </span><span class="s5">$AKEY</span><span class="s1"> --profile demouser</span></p>
<p class="p8"><span class="s7">aws configure </span><span class="s16">set</span><span class="s7"> aws_secret_access_key </span><span class="s10">$SKEY</span><span class="s7"> --profile demouser</span></p>
<p class="p11"><span class="s1">Configure endpoint specifics</span></p>
<p class="p7"><span class="s1">aws configure </span><span class="s4">set</span><span class="s1"> endpoint_url http://ceph-node4 --profile demouser</span></p>
<p class="p7"><span class="s1">aws configure </span><span class="s4">set</span><span class="s1"> region multizg --profile demouser</span></p>
<p class="p8"><span class="s7">aws configure </span><span class="s16">set</span><span class="s7"> ca_bundle </span><span class="s9">${</span><span class="s10">HOME</span><span class="s9">}</span><span class="s7">/rootCA.pem<span class="Apple-converted-space">  </span>--profile demouser</span></p>
<p class="p11"><span class="s1">Create an easy alias</span></p>
<p class="p10"><span class="s16">alias</span><span class="s13"> </span><span class="s10">aws</span><span class="s8">=</span><span class="s7">"aws --profile demouser"</span></p>
<p class="p11"><span class="s1">1. List available buckets</span></p>
<p class="p8"><span class="s7">aws s3 ls</span></p>
<p class="p11"><span class="s1">2. Create a 10MiB file and upload it to the bucket</span></p>
<p class="p7"><span class="s1">truncate -s 10M 10MB.bin</span></p>
<p class="p8"><span class="s7">aws --acl</span><span class="s8">=</span><span class="s7">public-read-write s3 cp ./10MB.bin s3://demo-bucket/10MB.bin</span></p>
<p class="p11"><span class="s1">3. Get a bucket listing to view the test object. Download the object to a local file</span></p>
<p class="p7"><span class="s1">aws s3 ls s3://demo-bucket</span></p>
<p class="p8"><span class="s7">aws s3 cp s3://demo-bucket/10MB.bin GET-10MB.bin</span></p>
<p class="p11"><span class="s1">4. Verify the data integrity</span></p>
<p class="p8"><span class="s16">echo</span><span class="s7"> </span><span class="s16">$(</span><span class="s7">openssl dgst -md5 ./10MB.bin | awk </span><span class="s14">'{print $2}'</span><span class="s16">)</span><span class="s7">;</span><span class="s16">echo</span><span class="s7"> </span><span class="s16">$(</span><span class="s7">openssl dgst -md5 ./GET-10MB.bin | awk </span><span class="s14">'{print $2}'</span><span class="s16">)</span></p>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">4.2. NFS Access</span></h3>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">4.2.1. Mount /nfs export</span></h4>
<p class="p11"><span class="s1">1. Change user to root</span></p>
<p class="p8"><span class="s7">sudo -i</span></p>
<p class="p11"><span class="s1">2. Create directory for mountpoint</span></p>
<p class="p8"><span class="s7">mkdir -p /mnt/nfs-cephfs</span></p>
<p class="p11"><span class="s1">3. Mount the CephFS NFS export</span></p>
<p class="p8"><span class="s7">mount -t nfs -o </span><span class="s10">vers</span><span class="s8">=4</span><span class="s7">.1,port</span><span class="s8">=2049</span><span class="s7"> ceph-node3:/nfs /mnt/nfs-cephfs</span></p>
<p class="p11"><span class="s1">4. Get a listing of the files in the new mountpoint</span></p>
<p class="p8"><span class="s7">ls -al /mnt/nfs-cephfs</span></p>
<p class="p11"><span class="s1">5. Use the touch command to create an empty file</span></p>
<p class="p8"><span class="s7">touch /mnt/nfs-cephfs/nfsfile</span></p>
<p class="p11"><span class="s1">6. Get a listing of the files in the new mountpoint</span></p>
<p class="p8"><span class="s7">ls -al /mnt/nfs-cephfs</span></p>
<h4 style="margin: 0.0px 0.0px 8.6px 0.0px; font: 17.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">4.2.2. Mount /demo-bucket export</span></h4>
<p class="p11"><span class="s1">1. Create directory for mountpoint</span></p>
<p class="p8"><span class="s7">mkdir -p /mnt/demo-bucket</span></p>
<p class="p11"><span class="s1">2. Mount the object bucket NFS export</span></p>
<p class="p8"><span class="s7">mount -t nfs -o </span><span class="s10">vers</span><span class="s8">=4</span><span class="s7">.1,port</span><span class="s8">=2049</span><span class="s7"> ceph-node3:/demo-bucket /mnt/demo-bucket</span></p>
<p class="p11"><span class="s1">4. Get a listing of the files in the new mountpoint</span></p>
<p class="p8"><span class="s7">ls -al /mnt/nfs-cephfs</span></p>
<h3 style="margin: 0.0px 0.0px 10.1px 0.0px; font: 20.2px 'Helvetica Neue'; color: #aa261c; -webkit-text-stroke: #aa261c"><span class="s1">4.3. RBD Access</span></h3>
<p class="p11"><span class="s1">1. Connect to one of the Ceph nodes</span></p>
<p class="p8"><span class="s7">ssh ceph-node1</span></p>
<p class="p11"><span class="s1">2. Create a pool to receive the virtual block</span></p>
<p class="p8"><span class="s7">ceph osd pool create rbd</span></p>
<p class="p11"><span class="s1">3. Assign worjkload type to the pool</span></p>
<p class="p8"><span class="s7">ceph osd pool application </span><span class="s16">enable</span><span class="s7"> rbd rbd</span></p>
<p class="p11"><span class="s1">4. Create virtual block device then list existing block devices</span></p>
<p class="p7"><span class="s1">rbd create rbd/test --size</span><span class="s6">=</span><span class="s1">1Gi</span></p>
<p class="p13"><span class="s1"></span><br></p>
<p class="p8"><span class="s7">rbd -p rbd ls</span></p>
<p class="p11"><span class="s1">5. Display information about virtual block device</span></p>
<p class="p6"><span class="s1">[source, shell</span></p>
<p class="p8"><span class="s7">rbd info rbd/test</span></p>
<p class="p11"><span class="s1">6. Map virtual block device to node</span></p>
<p class="p8"><span class="s7">rbd device map rbd/test</span></p>
<p class="p11"><span class="s1">7. List virtual block devices attached to the node</span></p>
<p class="p8"><span class="s7">rbd device list</span></p>
<p class="p11"><span class="s1">8. Format the virtual block device</span></p>
<p class="p8"><span class="s7">mkfs.ext4 /dev/rbd0</span></p>
<p class="p11"><span class="s1">9. Mount the file system you just created</span></p>
<p class="p7"><span class="s1">mkdir /mnt/myrbd</span></p>
<p class="p8"><span class="s7">mount /dev/rbd0 /mnt/myrbd</span></p>
<p class="p11"><span class="s1">10. Write some data to the filesystem</span></p>
<p class="p9"><span class="s4">echo</span><span class="s11"> </span><span class="s1">"Writing to my Ceph RBD Image"</span><span class="s11"> &gt;/mnt/myrbd/test.file</span></p>
<p class="p8"><span class="s7">dd </span><span class="s16">if</span><span class="s8">=</span><span class="s7">/dev/zero </span><span class="s10">of</span><span class="s8">=</span><span class="s7">/mnt/myrbd/dd.file </span><span class="s10">bs</span><span class="s8">=</span><span class="s7">4k </span><span class="s10">count</span><span class="s8">=1000</span></p>
<p class="p11"><span class="s1">11. Check how the virtual block device is being used</span></p>
<p class="p7"><span class="s1">ls -al /mnt/myrbd</span></p>
<p class="p13"><span class="s1"></span><br></p>
<p class="p8"><span class="s7">rbd du rbd/test</span></p>
<p class="p11"><span class="s1">12. Cleanup</span></p>
<p class="p7"><span class="s1">umount /mnt/myrbd</span></p>
<p class="p7"><span class="s1">rbd device unmap rbd/test</span></p>
<p class="p8"><span class="s7">rbd rm rbd/test</span></p>
<p class="p11"><span class="s1">13. Disconnect</span></p>
<p class="p14"><span class="s1">exit</span></p>
<p class="p15"><span class="s7">exit</span></p>
<p class="p16"><span class="s17">Last updated 2025-06-18 13:59:00 -0700</span></p>
</body>
</html>
